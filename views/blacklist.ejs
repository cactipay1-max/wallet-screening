<h1>Blacklist</h1>

<div class="card">
  <h2>Add Address</h2>
  <% if (error) { %>
    <div class="error"><%= error %></div>
  <% } %>
  <form method="POST" action="/blacklist">
    <div class="form-row" style="margin-bottom:10px">
      <div class="form-group">
        <label>Address</label>
        <input
          type="text"
          name="address"
          class="wide"
          placeholder="0x..."
          required
          autocomplete="off"
          spellcheck="false"
        />
      </div>
      <div class="form-group">
        <label>Chain</label>
        <select name="chain">
          <option value="ethereum">Ethereum</option>
          <option value="bsc">BSC</option>
          <option value="polygon">Polygon</option>
        </select>
      </div>
      <div class="form-group">
        <label>Category</label>
        <select name="category">
          <option value="internal">Internal</option>
          <option value="sanctions">Sanctions</option>
          <option value="scam">Scam</option>
          <option value="mixer">Mixer</option>
          <option value="other">Other</option>
        </select>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group" style="flex:1">
        <label>Note (optional)</label>
        <input type="text" name="note" placeholder="Reason or reference…" />
      </div>
      <div class="form-group">
        <label>&nbsp;</label>
        <button type="submit">Add to Blacklist</button>
      </div>
    </div>
  </form>
</div>

<div class="card">
  <h2>Blacklisted Addresses (<%= entries.length %>)</h2>
  <% if (entries.length === 0) { %>
    <p class="empty">No blacklisted addresses yet.</p>
  <% } else { %>
    <table>
      <thead>
        <tr>
          <th>Address</th>
          <th>Chain</th>
          <th>Category</th>
          <th>Note</th>
          <th>Added</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% entries.forEach(e => { %>
        <tr>
          <td class="mono"><%= e.address %></td>
          <td><%= e.chain %></td>
          <td>
            <form method="POST" action="/blacklist/<%= e.id %>/category" style="margin:0;display:flex;align-items:center;gap:6px">
              <select name="category" style="font-size:12px;padding:3px 6px;border:1px solid #d1d5db;border-radius:4px;background:#fff">
                <option value="internal"  <%- (e.category||'').toLowerCase() === 'internal'  ? 'selected' : '' %>>Internal</option>
                <option value="sanctions" <%- (e.category||'').toLowerCase() === 'sanctions' ? 'selected' : '' %>>Sanctions</option>
                <option value="scam"      <%- (e.category||'').toLowerCase() === 'scam'      ? 'selected' : '' %>>Scam</option>
                <option value="mixer"     <%- (e.category||'').toLowerCase() === 'mixer'     ? 'selected' : '' %>>Mixer</option>
                <option value="other"     <%- (e.category||'').toLowerCase() === 'other'     ? 'selected' : '' %>>Other</option>
              </select>
              <button type="submit" style="font-size:11px;padding:3px 8px;background:#f3f4f6;color:#374151;border:1px solid #d1d5db;border-radius:4px;cursor:pointer;font-weight:600">Save</button>
            </form>
          </td>
          <td class="meta"><%= e.note || '—' %></td>
          <td class="meta"><%= new Date(e.created_at).toLocaleString() %></td>
          <td>
            <form method="POST" action="/blacklist/<%= e.id %>/delete" style="margin:0"
                  onsubmit="return confirm('Remove this address from the blacklist?')">
              <button type="submit" class="btn-danger">Delete</button>
            </form>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</div>
